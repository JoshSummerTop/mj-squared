<% Current.meta_tags.set(title: t(".title")) %>

<% content_for :form_block do %>
  <!-- Logo Section -->
  <div class="mb-8 text-center">
    <%= link_to root_path, class: "inline-block" do %>
      <%= image_tag "logo.png", alt: Jumpstart.config.application_name, class: "h-16 w-auto mx-auto mb-4" %>
    <% end %>
    <h1 class="text-3xl font-bold text-gray-900 dark:text-gray-100 mb-2" style="font-family: 'Paytone One', sans-serif;"><%= t('.sign_up') %></h1>
    <p class="text-gray-600 dark:text-gray-400">
      <%= t(".login_html", link: link_to("log in to your account", new_session_path(resource_name), class: "font-semibold text-primary-500 hover:text-primary-600")) %>
    </p>
  </div>

  <% if @account_invitation %>
    <div class="flex items-center justify-center mb-6 p-4 bg-primary-50 dark:bg-primary-900/20 rounded-lg border border-primary-200 dark:border-primary-700">
      <%= image_tag avatar_url_for(@account_invitation.account), class: "h-8 w-8 rounded-full mr-3" %>
      <div class="text-sm text-primary-800 dark:text-primary-200">
        <strong><%= @account_invitation.invited_by.name %></strong> invited you to join <strong><%= @account_invitation.account.name %></strong>
      </div>
    </div>
  <% end %>

  <%= form_with(model: resource, as: resource_name, url: registration_path(resource_name, invite: params[:invite]), data: { turbo: false }, class: "space-y-6") do |f| %>
    <%= render "error_messages", resource: resource %>

    <%# Add any extra fields when creating an Account as part of registration %>
    <%= f.fields_for :owned_accounts do |a| %>
      <div class="form-group">
        <%= a.label :name, "Organization Name", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
        <%= a.text_field :name, autofocus: true, placeholder: "Enter organization name", class: "form-control w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100 transition duration-200" %>
      </div>
    <% end %>

    <div class="form-group">
      <%= f.label :name, "Full Name", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
      <%= f.text_field :name, autocomplete: "name", placeholder: "Enter your full name", class: "form-control w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100 transition duration-200" %>
    </div>

    <div class="form-group">
      <%= f.label :email, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
      <%= f.email_field :email, autocomplete: "email", placeholder: "Enter your email", class: "form-control w-full px-4 py-3 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100 transition duration-200" %>
    </div>

    <div class="form-group" data-controller="password-toggle">
      <%= f.label :password, class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
      <div class="relative">
        <%= f.password_field :password, autocomplete: "new-password", placeholder: "Create a password", class: "form-control w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100 transition duration-200", data: { password_toggle_target: "password" } %>
        <button type="button" 
                class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200" 
                data-password-toggle-target="toggle" 
                data-action="click->password-toggle#toggle">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
          </svg>
        </button>
      </div>
      <% if @minimum_password_length %>
        <p class="mt-2 text-sm text-gray-500 dark:text-gray-400">
          <svg class="w-4 h-4 inline mr-1" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
          </svg>
          <%= t('devise.shared.minimum_password_length', count: @minimum_password_length) %>
        </p>
      <% end %>
    </div>

    <div class="form-group" data-controller="password-toggle">
      <%= f.label :password_confirmation, "Confirm Password", class: "block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2" %>
      <div class="relative">
        <%= f.password_field :password_confirmation, autocomplete: "new-password", placeholder: "Confirm your password", class: "form-control w-full px-4 py-3 pr-12 rounded-lg border border-gray-300 dark:border-gray-600 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 dark:bg-gray-800 dark:text-gray-100 transition duration-200", data: { password_toggle_target: "password" } %>
        <button type="button" 
                class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors duration-200" 
                data-password-toggle-target="toggle" 
                data-action="click->password-toggle#toggle">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
          </svg>
        </button>
      </div>
    </div>

    <div class="form-group">
      <%= invisible_captcha %>
    </div>

    <div class="flex items-start">
      <%= f.check_box :terms_of_service, id: "tos", value: "1", class: "h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded mt-0.5 flex-shrink-0" %>
      <label for="tos" class="ml-3 text-sm text-gray-700 dark:text-gray-300 leading-5">
        <%= t ".terms_html", terms: link_to("terms of service", terms_path, target: "_blank", class: "text-primary-600 hover:text-primary-500 underline"), privacy: link_to("privacy policy", privacy_path, target: "_blank", class: "text-primary-600 hover:text-primary-500 underline") %>
      </label>
    </div>

    <div class="form-group">
      <%= f.button button_text(t('.sign_up'), disable_with: t(".submitting")), class: "w-full py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition duration-200" %>
    </div>
  <% end %>

  <%= render "devise/shared/links" %>
<% end %>

<%= render "devise/shared/form_block" %>
